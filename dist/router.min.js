!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.router=t()}(this,function(){"use strict";function e(){var e={_allEvents:Object.create(null),use:function(t,n){return t(e,n)||e},on:function(t,n,r){function i(){i.called||(e.off(t,i),n.apply(n,arguments),i.called=!0)}var o=e._allEvents[t]||(e._allEvents[t]=[]),a=r?i:n;return a.__sourceString=n.toString(),o.push(a),e},once:function(t,n){return e.on(t,n,!0),e},off:function(t,n){if(n&&e._allEvents[t]){var r=n.toString();e._allEvents[t]=e._allEvents[t].filter(function(e){return e.__sourceString!==r})}else t?e._allEvents[t]=[]:e._allEvents=Object.create(null);return e},emit:function(t){if("*"!==t){var n=[].slice.call(arguments);(e._allEvents[t]||[]).map(function(e){e.apply(e,n.slice(1))}),(e._allEvents["*"]||[]).map(function(e){e.apply(e,n)})}return e}};return e}function t(e,t){for(var n,r=[],i=0,u=0,c="",l=t&&t.delimiter||"/";null!=(n=A.exec(e));){var s=n[0],f=n[1],p=n.index;if(c+=e.slice(u,p),u=p+s.length,f)c+=f[1];else{var h=e[u],v=n[2],g=n[3],d=n[4],m=n[5],y=n[6],_=n[7];c&&(r.push(c),c="");var E=null!=v&&null!=h&&h!==v,x="+"===y||"*"===y,w="?"===y||"*"===y,k=n[2]||l,b=d||m;r.push({name:g||i++,prefix:v||"",delimiter:k,optional:w,repeat:x,partial:E,asterisk:!!_,pattern:b?a(b):_?".*":"[^"+o(k)+"]+?"})}}return u<e.length&&(c+=e.substr(u)),c&&r.push(c),r}function n(e){return encodeURI(e).replace(/[\/?#]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}function r(e){return encodeURI(e).replace(/[?#]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}function i(e){for(var t=new Array(e.length),i=0;i<e.length;i++)"object"==typeof e[i]&&(t[i]=new RegExp("^(?:"+e[i].pattern+")$"));return function(i,o){for(var a="",u=i||{},c=(o||{}).pretty?n:encodeURIComponent,l=0;l<e.length;l++){var s=e[l];if("string"!=typeof s){var f,p=u[s.name];if(null==p){if(s.optional){s.partial&&(a+=s.prefix);continue}throw new TypeError('Expected "'+s.name+'" to be defined')}if(j(p)){if(!s.repeat)throw new TypeError('Expected "'+s.name+'" to not repeat, but received `'+JSON.stringify(p)+"`");if(0===p.length){if(s.optional)continue;throw new TypeError('Expected "'+s.name+'" to not be empty')}for(var h=0;h<p.length;h++){if(f=c(p[h]),!t[l].test(f))throw new TypeError('Expected all "'+s.name+'" to match "'+s.pattern+'", but received `'+JSON.stringify(f)+"`");a+=(0===h?s.prefix:s.delimiter)+f}}else{if(f=s.asterisk?r(p):c(p),!t[l].test(f))throw new TypeError('Expected "'+s.name+'" to match "'+s.pattern+'", but received "'+f+'"');a+=s.prefix+f}}else a+=s}return a}}function o(e){return e.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function a(e){return e.replace(/([=!:$\/()])/g,"\\$1")}function u(e,t){return e.keys=t,e}function c(e){return e.sensitive?"":"i"}function l(e,t){var n=e.source.match(/\((?!\?)/g);if(n)for(var r=0;r<n.length;r++)t.push({name:r,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,asterisk:!1,pattern:null});return u(e,t)}function s(e,t,n){for(var r=[],i=0;i<e.length;i++)r.push(h(e[i],t,n).source);return u(new RegExp("(?:"+r.join("|")+")",c(n)),t)}function f(e,n,r){return p(t(e,r),n,r)}function p(e,t,n){j(t)||(n=t||n,t=[]);for(var r=(n=n||{}).strict,i=!1!==n.end,a="",l=0;l<e.length;l++){var s=e[l];if("string"==typeof s)a+=o(s);else{var f=o(s.prefix),p="(?:"+s.pattern+")";t.push(s),s.repeat&&(p+="(?:"+f+p+")*"),a+=p=s.optional?s.partial?f+"("+p+")?":"(?:"+f+"("+p+"))?":f+"("+p+")"}}var h=o(n.delimiter||"/"),v=a.slice(-h.length)===h;return r||(a=(v?a.slice(0,-h.length):a)+"(?:"+h+"(?=$))?"),a+=i?"$":r&&v?"":"(?="+h+"|$)",u(new RegExp("^"+a,c(n)),t)}function h(e,t,n){return j(t)||(n=t||n,t=[]),n=n||{},e instanceof RegExp?l(e,t):j(e)?s(e,t,n):f(e,t,n)}function v(e){return null==e||"function"!=typeof e&&"object"!=typeof e}function g(e,t,n,r){var i=v(r)?r:n(r);if(!t.has(i)){var o=e.call(this,r);return t.set(i,o),o}return t.get(i)}function d(e,t,n){var r=Array.prototype.slice.call(arguments,3),i=n(r);if(!t.has(i)){var o=e.apply(this,r);return t.set(i,o),o}return t.get(i)}function m(e,t,n,r,i){return n.bind(t,e,r,i)}function y(e,t){return m(e,this,1===e.length?g:d,t.cache.create(),t.serializer)}function _(){return JSON.stringify(arguments)}function E(){this.cache=Object.create(null)}function x(e){var t=e.indexOf("#");return~t?e.slice(t+1):""}function w(t,n){void 0===t&&(t={}),void 0===n&&(n={});var r=e();return r.use(z()),r.options=t,r.start=function(){var e=this;H=0,J.forEach(function(e){return e.stop()}),J.push(r),this.recursiveInvoke("activate");var t=[];this.recursive(function(e){t.push({options:e.options,routerPath:e._routerPath,regexp:e._regexp,name:e.name,fullName:e._fullName,depth:e._depth,keys:e._keys})});var n=I(k(t));C(function(t){var r=t.newSegment,i=t.oldSegment,o=n(r);n(i);if(!o)return e.emit("notfound");console.log(o),callHook(o,"beforeEnter"),callHook(o,"enter"),callHook(o,"update"),callHook(o,"beforeLeave")})},r.stop=function(){L()},r.activate=function(){this.parent?this._depth=this.parent._depth+1:this._depth=0,t.name||(this.name="anonymous"+H++),this._keys=[],this._fullName=this._getFullName(),this._regexp=N(this._getFullPath(),this._keys),this._routerPath=this._trace()},r.deactivate=function(){this._depth=0,this._fullName=null,this._regexp=null,this._routerPath=null},r._getFullName=function(){return this.parent?this.parent._getFullName()+"."+this.name:this.name},r._getFullPath=function(){return this.parent?this.parent._getFullPath()+t.path:t.path},r._trace=function(){for(var e=[this],t=this;t=t.parent;)e.unshift(t);return e},r}function k(e){void 0===e&&(e=[]);var t=b(e);return function(e){var n=t(e);if(n){var r=S({keys:n.keys,regexp:n.regexp,segment:e});return Object.assign({},n,{params:r})}}}function b(e){return void 0===e&&(e=[]),function(t){var n=e.filter(function(e){return e.regexp.test(t)}),r=0,i=n[0];return n.forEach(function(e){e._depth>r&&(r=e._depth,i=e)}),i}}function S(e){for(var t=e.segment,n=e.regexp,r=e.keys,i={},o=n.exec(t),a=0,u=r.length;a<u;a++){var c=r[a],l=c.name,s=o[a+1];s&&(i[l]=decodeURIComponent(s),c.repeat&&(i[l]=i[l].split(c.delimiter)))}return i}var R=function(e,t){return void 0===t&&(t={}),function(n){n.create=function(n){return e(n,t)}}},j=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)},N=h,O=t,U=i,$=p,A=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?|(\\*))"].join("|"),"g");N.parse=O,N.compile=function(e,n){return i(t(e,n))},N.tokensToFunction=U,N.tokensToRegExp=$,E.prototype.has=function(e){return e in this.cache},E.prototype.get=function(e){return this.cache[e]},E.prototype.set=function(e,t){this.cache[e]=t};var F={create:function(){return new E}},I=function(e,t){var n=t&&t.cache?t.cache:F,r=t&&t.serializer?t.serializer:_;return(t&&t.strategy?t.strategy:y)(e,{cache:n,serializer:r})},P={variadic:function(e,t){return m(e,this,d,t.cache.create(),t.serializer)},monadic:function(e,t){return m(e,this,g,t.cache.create(),t.serializer)}};I.strategies=P;var T,z=function(e){return void 0===e&&(e=[]),function(e){e.append=function(t){e.children=e.children||[],e.children.push(t),t.parent=this},e.recursiveInvoke=function(e){for(var t=[],n=arguments.length-1;n-- >0;)t[n]=arguments[n+1];"function"==typeof this[e]&&(i=this)[e].apply(i,t);var r=this.children||[];r.length>0&&r.forEach(function(n){return n.recursiveInvoke.apply(n,[e].concat(t))});var i},e.recursive=function(e){e(this);var t=this.children||[];t.length>0&&t.forEach(function(t){return t.recursive(e)})}}},C=function(e){T=function(t){e({newSegment:x(t.newURL),oldSegment:x(t.oldURL),e:t})},window.addEventListener("hashchange",T)},L=function(){window.removeEventListener("hashchange",T)},H=0,J=[];return function(t){return void 0===t&&(t={}),e().use(R(w,t))}});
//# sourceMappingURL=router.min.js.map
